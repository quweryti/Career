CREATE TABLE MEMBERS (
  MEMBER_ID   NUMBER
               GENERATED BY DEFAULT ON NULL AS IDENTITY,
  NAME        VARCHAR2(100 CHAR)    NOT NULL,
  EMAIL       VARCHAR2(200 CHAR)    NOT NULL,
  PASSWORD    VARCHAR2(255 CHAR)    NOT NULL,
  SIGNUP_DATE TIMESTAMP             DEFAULT SYSTIMESTAMP NOT NULL,
  IS_DELETED  NUMBER(1)             DEFAULT '0' NOT NULL,

  CONSTRAINT pk_members          PRIMARY KEY  (MEMBER_ID),
  CONSTRAINT uq_members_email    UNIQUE       (EMAIL),
  CONSTRAINT chk_is_deleted      CHECK        (IS_DELETED IN ('0','1'))
);

CREATE TABLE LINKS (
  LINK_ID    NUMBER
               GENERATED BY DEFAULT ON NULL AS IDENTITY,
  MEMBER_ID  NUMBER              NOT NULL,
  URL        VARCHAR2(2048 CHAR) NOT NULL,

  CONSTRAINT pk_links           PRIMARY KEY (LINK_ID),
  CONSTRAINT fk_links_member    FOREIGN KEY (MEMBER_ID)
                                  REFERENCES MEMBERS (MEMBER_ID)
);

CREATE TABLE FOLLOWS (
  FOLLOW_ID     NUMBER
                   GENERATED BY DEFAULT ON NULL AS IDENTITY,
  MEMBER_ID     NUMBER            NOT NULL,
  FOLLOWEE_ID   NUMBER            NOT NULL,

  CONSTRAINT pk_follows              PRIMARY KEY (FOLLOW_ID),
  CONSTRAINT fk_follows_member       FOREIGN KEY (MEMBER_ID)
                                         REFERENCES MEMBERS (MEMBER_ID),
  CONSTRAINT fk_follows_followee     FOREIGN KEY (FOLLOWEE_ID)
                                         REFERENCES MEMBERS (MEMBER_ID),
  CONSTRAINT uq_follows_pair         UNIQUE (MEMBER_ID, FOLLOWEE_ID)
);

CREATE TABLE PROFILE_IMAGE (
  ID         NUMBER
               GENERATED BY DEFAULT ON NULL AS IDENTITY,
  MEMBER_ID  NUMBER              NOT NULL,
  FILE_NAME  VARCHAR2(255 CHAR)  NOT NULL,
  FILE_PATH  VARCHAR2(500 CHAR)  NOT NULL,

  CONSTRAINT pk_profile_image        PRIMARY KEY (ID),
  CONSTRAINT fk_profile_image_member FOREIGN KEY (MEMBER_ID)
                                         REFERENCES MEMBERS (MEMBER_ID),
  CONSTRAINT uq_profile_image_member UNIQUE (MEMBER_ID)
);
